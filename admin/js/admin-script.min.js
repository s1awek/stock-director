const{createApp:createApp,ref:ref,computed:computed,watch:watch,nextTick:nextTick,onMounted:onMounted,onUnmounted:onUnmounted}=Vue,app=createApp({setup(){const e=ref(initialConditions||[]),n=ref({minQuantity:1,maxQuantity:null,message:""}),t=ref(!1);watch(e,(e=>{if(t.value=!0,e.length>0){const t=e[e.length-1];n.value.minQuantity=t.maxQuantity}else n.value.minQuantity=1}),{immediate:!0});const a=computed((()=>{const{minQuantity:t,maxQuantity:a,message:o}=n.value,i=null!==t&&null!==a&&parseInt(t)<parseInt(a),u=o.trim().length>0,r=0===e.value.length||e.value.every((e=>a>e.maxQuantity));return i&&u&&r}));function o(e){if(t.value){const n=mwsData.reloadMessage||"You have unsaved changes. Are you sure you want to leave?";return e.returnValue=n,n}}return onMounted((()=>{window.addEventListener("beforeunload",o)})),onUnmounted((()=>{window.removeEventListener("beforeunload",o)})),{conditions:e,newCondition:n,addCondition:()=>{a.value&&(e.value.push({...n.value}),e.value.sort(((e,n)=>e.minQuantity-n.minQuantity)),e.value.forEach(((n,t)=>{t>0&&(e.value[t].minQuantity=e.value[t-1].maxQuantity)})),n.value={minQuantity:e.value[e.value.length-1].maxQuantity,maxQuantity:null,message:""},nextTick((()=>{document.getElementById("maxQuantity").focus()})))},removeCondition:t=>{e.value.splice(t,1),0===e.value.length?n.value.minQuantity=1:t<e.value.length&&(e.value[t].minQuantity=e.value[t-1].maxQuantity)},saveConditions:async()=>{try{const n=await fetch(mwsData.ajax_url,{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({action:"save_conditions",nonce:mwsData.nonce,conditions:JSON.stringify(e.value)})});if(!n.ok)throw new Error("Network response was not ok.");(await n.json()).success?console.log("Settings saved"):console.error("Error from WP")}catch(e){console.error("Fetch error:",e)}t.value=!1},isValidNewCondition:a}}});app.mount("#wp-stock-director-settings");
//# sourceMappingURL=admin-script.min.js.map
